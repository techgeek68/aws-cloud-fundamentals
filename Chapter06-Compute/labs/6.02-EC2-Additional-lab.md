---

**Red Hat Enterprise Linux (RHEL) on EC2, connecting over SSH, installing and configuring Nginx, and deploying WebApps**

---

## Deploying a sample WebApp using HTML/CSS/JS

**Prerequisites**
- AWS account with permissions to launch EC2 instances.
- Ability to create/download a key pair (.pem) and keep it secure.
- Local terminal with SSH and optionally scp.
- Region: N. Virginia (us-east-1) for consistency with your reference.


**1) Launch an EC2 instance with Red Hat Linux**
- In AWS Console: Services → EC2 → Launch instance
  - Name: Web Server (or any you prefer)
  - AMI: Red Hat Enterprise Linux (e.g., RHEL 9) Free tier eligible
  - Instance type: t2.micro

- Key pair:
  - Create new key pair (type: RSA, format: .pem) OR choose an existing one
  - Download and keep the .pem safe
  
- Network settings:
  - VPC: default
  - Subnet: default subnet in your chosen AZ
  - Auto-assign public IP: Enable
  - Security group: Create new, e.g.,
      - Security group name:`Web Security Group`
      - Description: Allow HTTP and SSH Login
    - Inbound rules:
      - SSH, TCP 22, Source: My IP (recommended)
      - HTTP, TCP 80, Source: 0.0.0.0/0
      
- Storage: Keep default (e.g., 10 GiB gp3)

- Advanced details (optional):
  - Termination protection: Enable (optional)
  - Stop protection: You can enable after launch via Actions → Instance settings if desired

- Launch instance


**2) Connect via SSH from your local terminal**
- From your EC2 instance details, copy the Public IPv4 DNS or IP
- Ensure your private key has correct permissions:
- Syntax:
    chmod 400 /path/to/your-key.pem

- Example:
```
# Linux/Unix
chmod 400 AWSLabCSIT2087.pem 

# Windows PowerShell
icacls "AWSLabCSIT2087.pem" /inheritance:r
icacls "AWSLabCSIT2087.pem" /grant:r "$($env:USERNAME):R"
```

- Connect (RHEL default user is typically ec2-user on AWS RHEL images):
  - Syntax:
      ssh -i /path/to/your-key.pem ec2-user@PUBLIC_DNS_OR_IP
  - Example:
```
ssh -i "AWSLabCSIT2087.pem" ec2-user@3.237.179.102
```
  - You can copy from EC2 > Instances > <Instance-ID> > Connect > SSH client > Example
  - If ec2-user fails (rare on recent images), try redhat as the username.


**3) Install and configure Nginx**
- On the instance shell:
  - `sudo dnf -y install nginx`
  - `sudo systemctl enable --now nginx`
  - Confirm it’s running:
    - `systemctl status nginx`


**4) Deploy the simple HTML/CSS/JS web app**
- Use the file contents below and write them to `/usr/share/nginx/html`
- Command example :
  - `sudo vi /usr/share/nginx/html/index.html`
```html name=index.html
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>My Nginx Web App on RHEL</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="container">
      <h1>Hello from Nginx on RHEL in AWS!</h1>
      <p class="lead">
        This simple web app is served by Nginx on a Red Hat Enterprise Linux EC2 instance.
      </p>
      <button id="clickMe">Click me</button>
      <p id="message" aria-live="polite"></p>
    </main>
    <script src="app.js"></script>
  </body>
</html>
```

  - `sudo vi /usr/share/nginx/html/styles.css`
```css name=styles.css
:root {
  --bg: #0f172a;
  --fg: #e2e8f0;
  --accent: #38bdf8;
  --muted: #94a3b8;
}

* { box-sizing: border-box; }

html, body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--fg);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell,
    Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji",
    "Segoe UI Symbol", sans-serif;
}

.container {
  max-width: 720px;
  margin: 10vh auto;
  padding: 2rem;
  border: 1px solid #1f2937;
  border-radius: 12px;
  background: #111827;
  box-shadow: 0 10px 30px rgba(0,0,0,0.35);
}

h1 {
  margin-top: 0;
  color: var(--accent);
  letter-spacing: 0.3px;
}

.lead {
  color: var(--muted);
}

button {
  margin-top: 1rem;
  background: transparent;
  color: var(--fg);
  padding: 0.6rem 1rem;
  border: 1px solid var(--accent);
  border-radius: 8px;
  cursor: pointer;
  transition: all 160ms ease-in-out;
}
button:hover { background: rgba(56,189,248,0.15); }

#message {
  margin-top: 1rem;
  color: #a7f3d0;
  min-height: 1.2rem;
}
```

  - `sudo vi /usr/share/nginx/html/app.js`
```javascript name=app.js
document.addEventListener("DOMContentLoaded", () => {
  const btn = document.getElementById("clickMe");
  const msg = document.getElementById("message");
  if (!btn || !msg) return;

  btn.addEventListener("click", () => {
    const now = new Date().toLocaleString();
    msg.textContent = `Button clicked at ${now}. Have a great day!`;
  });
});
```

- Set The Permission
  - sudo chown root:root /usr/share/nginx/html/{index.html,styles.css,app.js}
  - sudo chmod 0644 /usr/share/nginx/html/{index.html,styles.css,app.js}
  
- Restart the Nginx webserver
  - sudo systemctl restart nginx


5) Validate in your browser
- In the EC2 console, copy the Public IPv4 for your instance
- Visit:
      http://YOUR_PUBLIC_IPV4/
- You should see “Hello from Nginx on RHEL in AWS!” and be able to click the button.


---


**Troubleshooting tips**
- Security group must allow inbound:
  - SSH TCP 22 from your IP
  - HTTP TCP 80 from 0.0.0.0/0
  
- OS firewall (firewalld) on RHEL:
  - Ensure http is allowed: sudo firewall-cmd --add-service=http --permanent && sudo firewall-cmd --reload
  
- Nginx status and logs:
  - sudo systemctl status nginx
  - sudo tail -n 100 /var/log/nginx/error.log
  - sudo tail -n 100 /var/log/nginx/access.log
  
- SELinux:
  - Serving from the default root (/usr/share/nginx/html) avoids SELinux context issues.
  
- Stop/termination protection (optional safeguards):
  - EC2 → Instances → Select your instance → Actions → Instance settings → Change termination protection or Change stop protection.


---

**Delete previous deployment**
  - cd /usr/share/nginx/html
    - sudo rm index.html styles.css app.js 

---

## Using Deploy a simple React-based web application.
- React Native is primarily for mobile apps. You’ll get two deployment paths:
  - Option A (Recommended): A standard React web app (using Vite).
  - Option B: A React Native app rendered for the web using Expo (react-native-web) and served by Nginx.


**Update System and Install Dependencies**

```bash
# Install Node.js (RHEL module; choose the current LTS stream)
curl -fsSL https://rpm.nodesource.com/setup_20.x | sudo bash - sudo yum install -y nodejs


# Git & build tools (optional)
sudo dnf -y install git tar

# Install Nginx
sudo dnf -y install nginx
sudo systemctl enable --now nginx
```

Test Nginx default page:
  - curl -I http://localhost


**Directory Layout for Deployment**
  - We’ll host our built static site at /var/www/reactapp and create a custom Nginx server block.
```bash
sudo mkdir -p /var/www/reactapp
sudo chown ec2-user:ec2-user /var/www/reactapp
```


**Configure Nginx (Custom Server Block)**
  - Create a dedicated config file instead of editing the default.
  - `sudo vi /etc/nginx/conf.d/reactapp.conf`
```bash
server {
    listen 80 default_server;
    server_name _;

    root /var/www/reactapp;
    index index.html;

    # React single-page app fallback (if using client routing)
    location / {
        try_files $uri $uri/ /index.html;
    }

    # Static cache headers (optional tweak)
    location ~* \.(?:js|css|png|jpg|jpeg|gif|svg|woff2?)$ {
        expires 7d;
        access_log off;
    }
}
```

```bash
sudo nginx -t
sudo systemctl restart nginx
```
  - At this point Nginx serves whatever is in /var/www/reactapp


**Option A (Recommended) – Build a Simple React Web App with Vite**
- Create a project
```bash
cd ~
npm create vite@latest my-react-app -- --template react
cd my-react-app
npm install
```

- Build
```bash
npm run build
```
  - This outputs static files to dist/.
    
- Deploy Build Artifacts
```bash
sudo rsync -av --delete dist/ /var/www/reactapp/
sudo restorecon -R /var/www/reactapp 2>/dev/null || true                 # SELinux context fix (if SELinux enforcing)
```

- Browse: http://PUBLIC_IPv4/


**Sample Application Deploy**
  - [ec2-user@ip-10-0-0-250 my-react-app]$ cd src/
  - [ec2-user@ip-10-0-0-250 src]$ sudo vi App.jsx
```
import { useState } from "react";
import { Text, View, Pressable } from "react-native";

export default function App() {
  const [count, setCount] = useState(0);
  return (
    <View style={{
      flex: 1,
      alignItems: "center",
      justifyContent: "center",
      padding: 24,
      backgroundColor: "#f8fafc"
    }}>
      <Text style={{ fontSize: 24, marginBottom: 12 }}>
        React Native (Web) on RHEL & Nginx
      </Text>
      <Pressable
        onPress={() => setCount(c => c + 1)}
        style={{
          paddingVertical: 10,
          paddingHorizontal: 16,
          backgroundColor: "#2563eb",
          borderRadius: 8
        }}
      >
        <Text style={{ color: "#fff" }}>You pressed {count} times</Text>
      </Pressable>
    </View>
  );
}
```

  - [ec2-user@ip-10-0-0-250 src]$ sudo vi main.jsx
```
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App.jsx";

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
```

  - [ec2-user@ip-10-0-0-250 src]$ cd ..
  - [ec2-user@ip-10-0-0-250 my-react-app]$ sudo vi index.html
```
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>React on RHEL EC2</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
```

  - [ec2-user@ip-10-0-0-250 my-react-app]$ sudo vi vite.config.js
```
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";

export default defineConfig({
  plugins: [react()],
  build: {
    outDir: "dist",
    sourcemap: false
  }
});
```

  - [ec2-user@ip-10-0-0-250 my-react-app]$ sudo vi package.json
```
{
  "name": "my-react-app",
  "private": true,
  "version": "0.0.1",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "^18.3.1",
    "react-dom": "^18.3.1"
  },
  "devDependencies": {
    "@types/react": "^18.3.5",
    "@types/react-dom": "^18.3.5",
    "vite": "^5.0.0"
  }
}
```

  - ClI Test
      `curl -s http://34.239.240.120 | head`
      


---


**Option B – React Native (Expo) Web Build**
  - Install Expo CLI
```bash
npm install -g expo-cli
cd ~
npx create-expo-app rn-web-app
cd rn-web-app
```

  - Run (For Dev Validation – optionally skip on EC2)
    - Dev servers are transient; for production, we build.
    
```bash
npx expo start --web
# (Ctrl+C to stop)
```

  - Production Web Build
```bash
npx expo export --platform web
# Or: npx expo export:web (older CLI variants)
```
  - Look for a dist/ (or .expo web export) directory containing index.html, assets, etc.
 
  - Deploy
```bash
sudo rsync -av --delete dist/ /var/www/reactapp/
sudo restorecon -R /var/www/reactapp 2>/dev/null || true
sudo systemctl reload nginx
```

  - Browse http://PUBLIC_IPv4/
