# Lab: Deploying a Web App with AWS Elastic Beanstalk


---

## Prerequisites

- AWS account (with IAM permissions for Elastic Beanstalk, EC2, S3)
- Region: us-east-1 (N. Virginia)
- Browser with pop-ups enabled

---

## Step 1: Prepare Your Application Package

1. **Get a sample app:**  
   Download a sample Tomcat app zip:  
   [tomcat.zip](https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/samples/tomcat.zip)

---

## Step 2: Create an S3 Bucket

Elastic Beanstalk uploads your application file to S3.  
You can let Beanstalk create and manage this, or create your own bucket if you want custom control.

- Console: S3
   - Create bucket > Name: `my-eb-apps-bucket`
   - Uncheck **Block Public Access settings for this bucket** & check **I acknowledge that the current settings might result in this bucket and the objects within becoming public.**
   -  all defaults OK.
   -  Click on the bucket name & Upload **tomcat.zip**

---

## Step 3: Create a New Elastic Beanstalk Application

1. In AWS Console, search for **Elastic Beanstalk** and open it.
2. Click **Create Environment**.
3. Environment tier **Web server environment**
4. **Application name:**  
   E.g., `my-elastic-beanstalk-app`
5. Environment information
   - Environment name: e.g., `my-eb-env`
   - Domain: auto-generated, or customize if you wish
   - Domain: e.g. techgeek68               **Check availability**
6.  **Platform:**  
   - Platform: `Tomcat`
   - Platform branch: Latest available
   - Platform version: Latest
7. **Application code:**  
   - Select "Upload your code"
   - Version label: V1.0
   - Choose **Local file** or **Public S3 URL**
   - If **Local file**
    - Click "Choose file" and select `tomcat.zip`
   - If **Public S3 URL**
      - s3://<Bucket_name>/tomcat.zip       e.g. s3://my-eb-apps-bucket/tomcat.zip
- Next
  
8. **Service access:**
   - Service role: LabRole
   - EC2 instance profile: LabInstanceProfile
- Next
  
9. **Instance settings** (Optional)
- Next
  
- **Database:** Leave "None" for this lab
  
10. **Configure instance traffic and scaling**
- **Root Volume** :Container default
- **Capacity:** 
   - **Auto scaling group** - Load balanced
   -  Min 2, Max 6 (default: 2)
- **Instance type:** t2.micro & t2.small
- **Load Balancer:** Application Load Balancer (default)
- **Rolling updates:** Leave default or adjust as needed

11. **Configure updates, monitoring, and logging** (optional)
- Next

---

## Step 5: Launch the Environment

1. Click **Create environment** to deploy.
2. Wait several minutes for AWS to provision infrastructure (EC2, ALB, Auto Scaling, Security Group).
3. Once complete, health should be **Ok**.

---

## Step 6: Test and Verify

1. Click the **environment URL** (ends in `elasticbeanstalk.com`).
2. You should see the sample application page.

---

## Step 7: Explore Underlying AWS Resources

1. **EC2:**  
   - Console > EC2 > Instances: Find two instances named for your environment.
2. **Load Balancer:**  
   - EC2 > Load Balancers: An ALB is created for traffic distribution.
3. **Auto Scaling Group:**  
   - EC2 > Auto Scaling Groups: Manages instance count.
4. **Security Group:**  
   - Allows HTTP (port 80) from anywhere.
5. **S3 Bucket:**  
   - Stores application version uploads.

---

## Step 8: Monitor and Manage

- In Beanstalk, use the **Monitoring** tab for metrics.
- Use **Configuration** to modify scaling, instance type, or environment variables.

---

## Step 9: Update Your Application (Optional)

1. Make changes to your application code.
2. Zip and upload a new version:
   - Beanstalk > Environment > Upload and Deploy

---

## Step 10: Clean Up

1. **Terminate the Beanstalk environment:**
   - Actions > Terminate environment (removes all associated AWS resources).
2. **(Optional) Delete S3 buckets** if you created custom ones.

---

## Troubleshooting

| Symptom                    | Possible Cause                 | Solution                                  |
|----------------------------|-------------------------------|-------------------------------------------|
| 404/503 after deploy       | App deploy not complete        | Wait for health status "Ok"               |
| Cannot access app          | Security group/firewall issue  | Ensure port 80 is open in security group  |
| Deploy fails               | Incorrect zip format           | Zip app files properly, not a folder      |

---

## Architecture Diagram

```
[User] --> [ALB] --> [EC2 Instance 1] (App Server)
                    [EC2 Instance 2] (App Server)
Instances auto-scaled, behind an ALB, managed by Elastic Beanstalk.
App code stored in S3.
```
