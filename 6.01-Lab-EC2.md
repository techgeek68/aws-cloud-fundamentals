# Lab 3: Introduction to Amazon EC2

---

## Lab Overview and Objectives

In this lab, I practice launching, resizing, managing, and monitoring an Amazon EC2 instance.

Amazon Elastic Compute Cloud (Amazon EC2) gives me scalable virtual servers in the AWS Cloud. It lets me get computing capacity quickly and adjust it as my needs change.

Key ideas:
- I can launch servers (instances) in minutes and scale up or down.
- I pay only for what I actually use.
- I keep full control over the OS, storage, networking, and security.
- EC2 helps me build resilient applications that can handle failures.

---

## Architectural Diagram
```
+---------------------------- AWS Account -----------------------------------+
| Region: us-east-1                                                          |
|                                                                            |
|  +------------------- Lab VPC --------------------+                        |
|  |                                                |                        |
|  |  +---------- PublicSubnet1 -----------+        |  +----------------+    |
|  |  |  EC2 Instance: Web Server          |        |  | PublicSubnet2  |    |
|  |  |  - AMI: Amazon Linux 2023          |        |  | (unused)       |    |
|  |  |  - Type: t2.micro -> t2.small      |        |  +----------------+    |
|  |  |  - Termination protection: ON      |        |                        |
|  |  |  - Stop protection: ON then OFF    |        |                        |
|  |  |  - User Data: installs Apache      |        |                        |
|  |  |  - Root Volume: 8 GiB -> 10 GiB    |        |                        |
|  |  +------------------------------------+        |                        |
|  |             | Security Group (initial: no inbound)                      |
|  |             | Updated: Allow HTTP (80) from 0.0.0.0/0                   |
|  +-------------|-----------------------------------------------------------+
|                |                                                           |
|        (Browser HTTP)                                                      |
|                |                                                           |
|        +-------v-------+                                                   |
|        |   User        |--(AWS Console API calls: launch, modify, stop...) |
|        +---------------+                                                   |
|                                                                            |
| CloudWatch: Metrics (CPU, Status Checks), System Log, Console Screenshot   |
| Service Quotas: Viewed for EC2 limits                                      |
+----------------------------------------------------------------------------+
```

---

## Task 1: Launch My Amazon EC2 Instance

Goal: Launch an Amazon EC2 instance with termination protection and stop protection, and use a User Data script to set up a simple web server.

### Step 1: Open the EC2 Console
- In the AWS Management Console, I choose Services → Compute → EC2.
- I confirm the region is N. Virginia (us-east-1). If not, I switch to it.

### Step 2: Start the Launch Wizard
- I choose Launch instance → Launch instance.

### Step 3: Name and Tags
- I set the instance name to: Web Server.
- This creates a tag with Key: Name and Value: Web Server.
- Tags help me organize resources (e.g., by purpose, owner, or environment).

### Step 4: Application and OS Image (AMI)
- I keep the default Amazon Linux entry (Amazon Linux 2023).
- An AMI includes:
  - A template for the root volume (OS and optional software).
  - Launch permissions (who can use it).
  - Block device mappings (attached volumes).

### Step 5: Instance Type
- I keep the default type: t2.micro (1 vCPU, 1 GiB memory).
- Instance types offer different mixes of CPU, memory, storage, and networking.

### Step 6: Key Pair (Login)
- For the Key pair name, I chose: vockey.
- EC2 uses public–key cryptography for secure access.

### Step 7: Network Settings
- I click Edit next to Network settings.
- VPC: I select 'default' VPC. (Not Edited)
- Subnet: I leave the default PublicSubnet1 (it assigns a public IP automatically).
- Firewall (Security groups):
  - I choose Create security group.
  - Security group name: 'Web Security Group'
  - Description: Security group for my web server
  - I removed the default inbound rule, so there are no inbound rules at this time.
  - (A security group works like a virtual firewall for my instance.)

### Step 8: Configure Storage
- I keep the default root volume: 8 GiB EBS.
- This is the root (boot) volume for the instance.

### Step 9: Advanced Details
- I expand the Advanced details.
- Termination protection: I select Enable (prevents accidental termination).
- User data: I paste the following script:

```bash
#!/bin/bash
# Student: <your_GitHub_username>
# Lab 3 EC2 User Data – minimal plus personal comments (keeps grading compatibility)
dnf install -y httpd
systemctl enable httpd
systemctl start httpd
# Preserve EXACT required line for grader below:
echo '<html><h1>  Hello from <student_name>'s server. Today it’s a simple page; tomorrow I’ll architect cloud-native solutions.</h1></html>' > /var/www/html/index.html
```

What the script does:
- Installs Apache (httpd).
- Enables it to start on boot.
- Starts the service now.
- Creates a simple HTML page.

### Step 10: Launch the Instance
- I scroll to the bottom and choose Launch instance.
- I see a success message.  


### Step 11: View the Instance
- I choose View all instances.
- I select the instance named Web Server.
- In the Details tab, I review:
  - Instance type
  - Network settings
  - Security group
  - Public IPv4 DNS (for Internet access)
- Initial states:
  - Pending → Initializing → Running.

### Step 12: Wait for Health
- I wait until:
  - Instance state: Running
  - Status checks: 2/2 checks passed

---

## Task 2: Monitor My Instance

Goal: Use built-in monitoring features (status checks, logs, metrics, console output).

### Step 1: Status Checks
- I select the instance and open the Status checks tab.
- Both System reachability and Instance reachability tests have passed.

### Step 2: Monitoring (CloudWatch Metrics)
- I open the Monitoring tab.
- I see basic metrics (a few at first since it was just launched).
- I can enlarge any graph via the three dots menu.
- Basic (5-minute) monitoring is enabled by default; detailed (1-minute) is optional.

### Step 3: View System Log
- I choose Actions → Monitor and troubleshoot → Get system log.
- I review the console output (useful for debugging boot issues).
- I confirm the HTTP package installed via user data.
- I choose Cancel to close.

### Step 4: View Instance Screenshot
- With Web Server still selected:
  - Actions → Monitor and troubleshoot → Get instance screenshot.
- I view the virtual console screenshot (useful if SSH/RDP fails).
- I choose Cancel.

---

## Task 3: Update Security Group and Access the Web Server

Goal: Allow HTTP traffic and view the web page created by user data.

### Step 1: Get Public IP
- I select the Web Server instance and copy its Public IPv4 address from the Details tab.

### Step 2: Test Access (Before Adding Rule)
- I open a new browser tab, paste the IP, and press Enter.
- Question: Can I access the web page?  
  Answer: No. The security group currently blocks inbound port 80 (HTTP). This shows how security groups act as firewalls.

### Step 3: Open Security Groups
- I return to the EC2 console tab.
- In the left navigation pane, I choose Security Groups.
- I select the Web Server security group.

### Step 4: Add Inbound Rule
- I open the Inbound rules tab (currently empty).
- I choose Edit inbound rules → Add rule:
  - Type: HTTP
  - Source: Anywhere-IPv4
- I choose Save rules.

### Step 5: Refresh Web Page
- I go back to the browser tab with the instance IP and refresh.
- I now see: Hello from <student_name>'s server. Today it’s a simple page; tomorrow I’ll architect cloud-native solutions.


---

## Task 4: Resize My Instance (Instance Type and EBS Volume)

Goal: Stop the instance, change the instance type (scale up), and increase the disk size.

### Part A: Stop the Instance
1. In EC2 → Instances, I select Web Server.
2. Instance state → Stop instance.
3. I confirm by choosing Stop.
4. I wait until the state shows Stopped.



Note: While stopped, I am not billed for compute time, but I still pay for EBS storage.

### Part B: Change Instance Type
1. With instance selected:
   - Actions → Instance settings → Change instance type.
2. Instance type: t2.small
3. I choose Apply.
   (t2.small has twice the memory of t2.micro. Other types may be restricted.)

### Part C: Enable Stop Protection
1. Actions → Instance settings → Change stop protection.
2. I select Enable.
3. I choose Save.

> Note: Stop protection blocks accidental stopping via the API or console.

### Part D: Resize the EBS Volume
1. With instance still selected:
   - Storage tab → Click the Volume ID link.
2. On the volume list, I check the volume.
3. Actions → Modify volume.
4. I changed the size from 8 to 10 GiB (larger sizes may be restricted).
5. I choose Modify → Modify again to confirm.


### Part E: Start the Instance
1. Return to Instances.
2. Select Web Server.
3. Instance state → Start instance.


---

## Task 5: Explore EC2 Limits (Service Quotas)

Goal: View EC2 service quotas for the region.

### Steps
1. In the AWS console search bar, I type Service Quotas and open it.
2. In AWS services, I search for EC2 and select Amazon Elastic Compute Cloud (Amazon EC2).
3. In Find quota, I type running on-demand (do not select—just filter).
4. I observe limits, for instance, families (e.g., Running On-Demand Standard...).
5. If I owned the AWS account, I could request quota increases where allowed.


---

## Task 6: Test Stop Protection

Goal: Attempt to stop the instance while stop protection is enabled, then disable protection and stop it.

### Step 1: Navigate Back to EC2
- I search for EC2 in the console and open it.

### Step 2: Attempt to Stop
- Instances → Select Web Server.
- Instance state → Stop instance → Stop.
- I receive an error similar to:
  "Failed to stop the instance i-1234567xxx. The instance 'i-1234567xxx' may not be stopped. Modify its 'disableApiStop' instance attribute and try again."



### Step 3: Disable Stop Protection
- Actions → Instance settings → Change stop protection.
- I uncheck Enable.
- I choose Save.

### Step 4: Stop the Instance
- With Web Server selected again:
  - Instance state → Stop instance → Stop.

---

